{"ast":null,"code":"import _regeneratorRuntime from\"/Users/wlp6897/newProjects/cordovaProjects/installment/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/wlp6897/newProjects/cordovaProjects/installment/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import\"antd-mobile/lib/toast/style\";import _Toast from\"antd-mobile/lib/toast\";import _asyncToGenerator from\"/Users/wlp6897/newProjects/cordovaProjects/installment/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/wlp6897/newProjects/cordovaProjects/installment/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/wlp6897/newProjects/cordovaProjects/installment/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/wlp6897/newProjects/cordovaProjects/installment/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/wlp6897/newProjects/cordovaProjects/installment/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{HashRouter as Router,Route}from'react-router-dom';import Routers from'@/plugins/libs/routerMap';import{connect}from'react-redux';import{CLIENT_INTERFACE}from'@/plugins/libs/interfaceMap';import{SET_USER_INFO,SET_REDIRECT}from'@/store/actions';import axios from'@/plugins/requestServer/httpClient';import{getStorage}from'@/plugins/common/storage';import Main from'@/views/Main';// import Login from '@/views/Login'\nvar App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.fetchCheckLogin=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var storageUserInfo,res,userData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!_this.props.user.loginFlag){_context.next=3;break;}if(window.location.pathname==='/login'){window.location.pathname='/main/home';}return _context.abrupt(\"return\");case 3://本地是否有存储用户信息\nstorageUserInfo=getStorage('storageUserInfo');//根据本地存储的用户信息，进行请求token是否有效登录，如果有效则更新token值\n_context.prev=4;_context.next=7;return axios.get(CLIENT_INTERFACE.CHECK_IS_LOGIN);case 7:res=_context.sent;if(!(res.data.err!=='0')){_context.next=11;break;}_Toast.info(res.data.msg,1);return _context.abrupt(\"return\");case 11:userData=_objectSpread(_objectSpread({},storageUserInfo),res.data.result);_this.props.setUserInfo(userData);if(window.location.pathname==='/login'){window.location.pathname='/main/home';}console.log('已经登录了');_context.next=21;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](4);console.log(_context.t0);_Toast.info('请求异常',1);//需删除\ncase 21:case\"end\":return _context.stop();}}},_callee,null,[[4,17]]);}));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.fetchCheckLogin();case 2:case\"end\":return _context2.stop();}}},_callee2,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()//是否已经登录过及查证token是否是有效登录，并更新token\n},{key:\"render\",value:function render(){var loginFlag=this.props.user.loginFlag;return/*#__PURE__*/React.createElement(Router,null,Routers.map(function(item,index){if(item.path!=='/login'){// return (<Route path={item.path} key={index} exact component={item.loginFlag&&!loginFlag?Login:item.component}></Route>)\nreturn/*#__PURE__*/React.createElement(\"div\",{key:index},/*#__PURE__*/React.createElement(Route,{path:item.path,key:index,exact:item.exact,component:item.component}));}else{return/*#__PURE__*/React.createElement(Route,{path:item.path,key:index,exact:true,component:loginFlag?Main:item.component});}}));}}]);return App;}(React.Component);export default connect(function(state,props){return state;},{setUserInfo:function setUserInfo(data){return{type:SET_USER_INFO,data:data};},setRedirectPath:function setRedirectPath(data){return{type:SET_REDIRECT,data:data};}})(App);","map":null,"metadata":{},"sourceType":"module"}